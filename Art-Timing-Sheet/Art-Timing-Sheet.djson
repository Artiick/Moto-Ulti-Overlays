{"Variables":{"DashboardVariables":[]},"DashboardDebugManager":{},"Version":2,"Id":"fed72d31-093b-40a7-9731-9bda591d7496","BaseHeight":315,"BaseWidth":264,"BackgroundColor":"#FF000000","Screens":[{"RenderingSkip":0,"Name":"Screen","InGameScreen":true,"IdleScreen":true,"PitScreen":false,"ScreenId":"d050f82f-f5ea-4e05-a419-097ab5bf6c7a","AllowOverlays":true,"IsForegroundLayer":false,"IsOverlayLayer":false,"OverlayTriggerExpression":{"Expression":""},"ScreenEnabledExpression":{"Expression":""},"OverlayMaxDuration":0,"OverlayMinDuration":0,"IsBackgroundLayer":false,"BackgroundColor":"#00FFFFFF","Items":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.ImageItem, SimHub.Plugins","AutoSize":false,"BackgroundColor":"#FFFF0000","Height":315.0,"Left":0.0,"Top":0.0,"Visible":false,"Width":264.0,"IsFreezed":true,"Name":"Alignment","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":false,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":25.0,"Text":"44.444","TextColor":"#FF00FF00","HorizontalAlignment":1,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":25.0,"Left":122.7,"Top":286.3,"Visible":true,"Width":103.0,"IsFreezed":true,"Name":"SPLIT","RenderingSkip":1,"MinimumRefreshIntervalMS":17.0,"Bindings":{"Text":{"FormatString":"0.000","Formula":{"Expression":"toshorttime((secondstotimespan([PersistantTrackerPlugin.SessionBestLastLapDelta])), 3,true, false)"},"Mode":2},"TextColor":{"Formula":{"Expression":"[PersistantTrackerPlugin.SessionBestLastLapDelta] = 0 ? '#ffffff': (\r\n  [PersistantTrackerPlugin.SessionBestLastLapDelta] < 0 ? '#00ff7f': '#ff0033'\r\n)"},"Mode":2},"Visible":{"Formula":{"Expression":"changed(3000, [PersistantTrackerPlugin.SessionBestLastLapDelta]) and [CurrentLap]!=1"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":true,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":38.0,"Text":"44:44.444","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":114.0,"Top":245.8,"Visible":true,"Width":137.2,"Name":"PRED.-Time","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Text":{"FormatString":"mm\\:ss\\.fff","Formula":{"Expression":"if(\r\n  [CurrentLap] = 1,\r\n  if(\r\n    timespantoseconds([AllTimeBest]) = 0,\r\n    '--:---.---',\r\n    secondstotimespan(\r\n      timespantoseconds([AllTimeBest]) + [PersistantTrackerPlugin.AllTimeBestLiveDeltaSeconds]\r\n    )\r\n  ),\r\n  if(\r\n    timespantoseconds([BestLapTime]) = 0,\r\n    '--:---.---',\r\n    secondstotimespan(\r\n      timespantoseconds([BestLapTime]) + [PersistantTrackerPlugin.SessionBestLiveDeltaSeconds]\r\n    )\r\n  )\r\n)"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"PRED.","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":17.8,"Top":245.8,"Visible":true,"Width":105.0,"Name":"PRED","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0}],"Visible":true,"Name":"Predicted","RenderingSkip":1,"MinimumRefreshIntervalMS":17.0,"Bindings":{"Visible":{"Formula":{"Expression":"!changed(3000,[LastLapTime]) and timespantoseconds([BestLapTime])!=0"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":true,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":38.0,"Text":"44:44.444","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":114.0,"Top":245.8,"Visible":true,"BlinkDelay":200.0,"BlinkEnabled":true,"Width":136.2,"Name":"LAST-Time","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Text":{"FormatString":"mm\\:ss\\.fff","Formula":{"Expression":"if(timespantoseconds([LastLapTime])=0, '--:---.---', [LastLapTime])"},"Mode":2},"TextColor":{"Formula":{"Expression":"if(changed(1200, [LastLapTime]),\r\n  if(\r\n    (timespantoseconds([LastLapTime]) / timespantoseconds([BestLapTime]) * 100) <= 100,\r\n    '#9500ff',\r\n    if(\r\n      (timespantoseconds([LastLapTime]) / timespantoseconds([BestLapTime]) * 100) <= 100.125,\r\n      '#00ff7f',\r\n      '#ff0033'\r\n    )\r\n  ),\r\n  '#ffffff'\r\n)"},"Mode":2},"BlinkEnabled":{"Formula":{"Expression":"changed(1199, [LastLapTime])"},"Mode":2},"Visible":{"Formula":{"Expression":"timespantoseconds([CurrentLapTime])>0"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"LAST","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":17.8,"Top":245.8,"Visible":true,"Width":105.0,"Name":"LAST","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Visible":{"Formula":{"Expression":"timespantoseconds([CurrentLapTime])>0"},"Mode":2}}}],"Visible":false,"Name":"Last","RenderingSkip":1,"MinimumRefreshIntervalMS":17.0,"Bindings":{"Visible":{"Formula":{"Expression":"changed(3000,[LastLapTime])=1"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":true,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"BEST","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":17.8,"Top":198.8,"Visible":true,"Width":105.0,"Name":"BEST","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":38.0,"Text":"44:44.444","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":114.0,"Top":198.8,"Visible":true,"Width":138.2,"Name":"BEST-Time","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Text":{"FormatString":"mm\\:ss\\.fff","Formula":{"Expression":"if(\r\n  [CurrentLap] = 1,\r\n  if(\r\n    timespantoseconds([AllTimeBest]) = 1,\r\n    '--:---.---',\r\n    [AllTimeBest]\r\n  ),\r\n  if(\r\n    timespantoseconds([BestLapTime]) = 0,\r\n    '--:---.---',\r\n    [BestLapTime]\r\n  )\r\n)"},"Mode":2}}}],"Visible":true,"Name":"Best","RenderingSkip":1,"MinimumRefreshIntervalMS":17.0,"Bindings":{"Visible":{"Formula":{"Expression":"[CurrentLap] > 1"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":true,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"CURRENT LAP","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":40.6,"Left":17.8,"Top":84.9,"Visible":true,"Width":169.2,"Name":"C-LAP","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":66.0,"Text":"44:44.444","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"CharWidth":29.6,"SpecialCharsWidth":12.5,"BackgroundColor":"#00FFFFFF","Height":82.9,"Left":16.8,"Top":122.8,"Visible":true,"Width":236.2,"Name":"CURRENT-Lap","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Text":{"FormatString":"mm\\:ss\\.fff","Formula":{"Expression":"[CurrentLapTime]"},"Mode":2},"TextColor":{"Formula":{"Expression":"if([PersistantTrackerPlugin.LapInvalidated] = 'true', '#ff0000', '#ffffff')"},"Mode":2},"Visible":{"Formula":{"Expression":"if([CurrentLap] > 1 && timespantoseconds([LastLapTime]) = 0, 0, 1)"},"Mode":2}}}],"Visible":true,"Name":"Current lap","RenderingSkip":0,"MinimumRefreshIntervalMS":1.0,"Bindings":{"Visible":{"Formula":{"Expression":"timespantoseconds([CurrentLapTime])>0"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"PEN","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":17.8,"Top":37.2,"Visible":false,"Width":105.0,"IsFreezed":true,"Name":"PEN","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0}],"Visible":true,"Name":"Normal Race","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Visible":{"Formula":{"Expression":"if([CurrentLap] > 1 && timespantoseconds([LastLapTime]) = 0, 0, 1)"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":false,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":25.0,"Text":"44.444","TextColor":"#FF00FF00","HorizontalAlignment":1,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":25.0,"Left":122.7,"Top":286.3,"Visible":true,"Width":103.0,"IsFreezed":true,"Name":"SPLIT","RenderingSkip":10,"MinimumRefreshIntervalMS":100.0,"Bindings":{"Text":{"FormatString":"0.000","Formula":{"JSExt":0,"Interpreter":1,"Expression":"var CompletedLaps = $prop('CompletedLaps');\r\nvar RaceTime = $prop('GameRawData.CurrentRaceTime');\r\nvar BestLapTimeStr = \"\" + $prop('BestLapTime'); // Force string conversion\r\n\r\n// **Ensure BestLapTime is valid**\r\nif (!BestLapTimeStr || typeof BestLapTimeStr !== \"string\" || BestLapTimeStr.length < 12) {\r\n    return \"Error: Invalid BestLapTimeStr\";\r\n}\r\n\r\n// **Function to parse hh:mm:ss.fff0000 format into seconds**\r\nfunction parseTimeToSeconds(timeStr) {\r\n    var hours = parseInt(timeStr.substring(0, 2)) || 0;\r\n    var minutes = parseInt(timeStr.substring(3, 5)) || 0;\r\n    var seconds = parseInt(timeStr.substring(6, 8)) || 0;\r\n    var milliseconds = parseInt(timeStr.substring(9, 12)) || 0;\r\n\r\n    return (hours * 3600) + (minutes * 60) + seconds + (milliseconds / 1000);\r\n}\r\n\r\n// **Parse BestLapTime**\r\nvar BestLapTimeSec = parseTimeToSeconds(BestLapTimeStr);\r\nif (BestLapTimeSec <= 0) return \"Error: BestLapTimeSec Invalid\";\r\n\r\n// **Initialize global variables**\r\nif (typeof globalThis.LapStartTime === 'undefined') {\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.LastLapTimeSec = 0;\r\n    globalThis.CompletedLapStored = 0;\r\n    globalThis.LastLapValidatedTime = 0; // New: Buffer storage\r\n}\r\n\r\n// **Hard reset when session starts**\r\nif (CompletedLaps === 0 || RaceTime < globalThis.LapStartTime) {\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.LastLapTimeSec = 0;\r\n    globalThis.CompletedLapStored = 0;\r\n    globalThis.LastLapValidatedTime = 0;\r\n    return \"+0.000\";\r\n}\r\n\r\n// **Store last lap time when CompletedLaps updates**\r\nif (CompletedLaps > globalThis.CompletedLapStored) {\r\n    globalThis.LastLapTimeSec = RaceTime - globalThis.LapStartTime;\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.CompletedLapStored = CompletedLaps;\r\n    globalThis.LastLapValidatedTime = RaceTime + 0.100; // Add 100ms buffer\r\n}\r\n\r\n// **Wait for the buffer time to pass before calculating delta**\r\nif (RaceTime < globalThis.LastLapValidatedTime) {\r\n    return \"+0.000\"; // Temporary return value until buffer expires\r\n}\r\n\r\n// **Ensure LastLapTime is valid**\r\nif (globalThis.LastLapTimeSec <= 0) return \"+0.000\";\r\n\r\n// **Calculate Delta**\r\nvar delta = globalThis.LastLapTimeSec - BestLapTimeSec;\r\nvar prefix = delta < 0 ? \"-\" : \"+\";\r\ndelta = Math.abs(delta);\r\n\r\n// **Format Delta as s.fff (or ss.fff if >= 10s)**\r\nvar deltaSeconds = Math.floor(delta);\r\nvar deltaMilliseconds = Math.floor((delta - deltaSeconds) * 1000);\r\n\r\nvar formattedDelta = \r\n    (deltaSeconds >= 10 ? deltaSeconds.toString().padStart(2, '0') : deltaSeconds) + \".\" +\r\n    deltaMilliseconds.toString().padStart(3, '0');\r\n\r\nreturn prefix + formattedDelta;"},"Mode":2},"TextColor":{"Formula":{"JSExt":0,"Interpreter":1,"Expression":"var CompletedLaps = $prop('CompletedLaps');\r\nvar RaceTime = $prop('GameRawData.CurrentRaceTime');\r\nvar BestLapTimeStr = \"\" + $prop('BestLapTime'); // Force string conversion\r\n\r\n// **Ensure BestLapTime is valid**\r\nif (!BestLapTimeStr || typeof BestLapTimeStr !== \"string\" || BestLapTimeStr.length < 12) {\r\n    return \"#ffffff\"; // Default white if invalid\r\n}\r\n\r\n// **Function to parse hh:mm:ss.fff0000 format into seconds**\r\nfunction parseTimeToSeconds(timeStr) {\r\n    var hours = parseInt(timeStr.substring(0, 2)) || 0;\r\n    var minutes = parseInt(timeStr.substring(3, 5)) || 0;\r\n    var seconds = parseInt(timeStr.substring(6, 8)) || 0;\r\n    var milliseconds = parseInt(timeStr.substring(9, 12)) || 0;\r\n\r\n    return (hours * 3600) + (minutes * 60) + seconds + (milliseconds / 1000);\r\n}\r\n\r\n// **Parse BestLapTime**\r\nvar BestLapTimeSec = parseTimeToSeconds(BestLapTimeStr);\r\nif (BestLapTimeSec <= 0) return \"#ffffff\"; // Default color if invalid\r\n\r\n// **Initialize global variables**\r\nif (typeof globalThis.LapStartTime === 'undefined') {\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.LastLapTimeSec = 0;\r\n    globalThis.CompletedLapStored = 0;\r\n    globalThis.LastLapValidatedTime = 0; // Buffer storage\r\n}\r\n\r\n// **Hard reset when session starts**\r\nif (CompletedLaps === 0 || RaceTime < globalThis.LapStartTime) {\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.LastLapTimeSec = 0;\r\n    globalThis.CompletedLapStored = 0;\r\n    globalThis.LastLapValidatedTime = 0;\r\n    return \"#ffffff\"; // Default white\r\n}\r\n\r\n// **Store last lap time when CompletedLaps updates**\r\nif (CompletedLaps > globalThis.CompletedLapStored) {\r\n    globalThis.LastLapTimeSec = RaceTime - globalThis.LapStartTime;\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.CompletedLapStored = CompletedLaps;\r\n    globalThis.LastLapValidatedTime = RaceTime + 0.100; // Add 100ms buffer\r\n}\r\n\r\n// **Wait for the buffer time to pass before calculating color**\r\nif (RaceTime < globalThis.LastLapValidatedTime) {\r\n    return \"#ffffff\"; // Temporary default color\r\n}\r\n\r\n// **Ensure LastLapTime is valid**\r\nif (globalThis.LastLapTimeSec <= 0) return \"#ffffff\";\r\n\r\n// **Calculate Delta**\r\nvar delta = globalThis.LastLapTimeSec - BestLapTimeSec;\r\n\r\n// **Return Color Based on Delta**\r\nreturn delta === 0 ? \"#ffffff\" : (delta < 0 ? \"#00ff7f\" : \"#ff0033\");"},"Mode":2},"Top":{"Formula":{"Expression":"if([CurrentLap] > 2 && changed(3000, [CurrentLap]), 286.3, 350)"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":true,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":38.0,"Text":"44:44.444","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":214.0,"Top":245.8,"Visible":true,"BlinkDelay":200.0,"BlinkEnabled":true,"Width":137.2,"Name":"LAST-Time","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Text":{"FormatString":"mm\\:ss\\.fff","Formula":{"JSExt":0,"Interpreter":1,"Expression":"var CompletedLaps = $prop('CompletedLaps');\r\nvar RaceTime = $prop('GameRawData.CurrentRaceTime');\r\n\r\n// Initialize global variables if not set\r\nif (typeof globalThis.LapStartTime === 'undefined') {\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.LastLapTime = \"00:00.000\"; \r\n    globalThis.CompletedLapStored = 0;\r\n}\r\n\r\n// **Hard reset when a new session starts**\r\nif (CompletedLaps === 0 || RaceTime < globalThis.LapStartTime) {\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.LastLapTime = \"00:00.000\"; \r\n    globalThis.CompletedLapStored = 0;\r\n    return globalThis.LastLapTime;\r\n}\r\n\r\n// **Capture lap times based on CompletedLaps update**\r\nif (CompletedLaps > globalThis.CompletedLapStored) {\r\n    var lapTime = RaceTime - globalThis.LapStartTime; // Subtract timestamps\r\n\r\n    var minutes = Math.floor(lapTime / 60);\r\n    var seconds = Math.floor(lapTime % 60);\r\n    var milliseconds = Math.floor((lapTime - Math.floor(lapTime)) * 1000);\r\n\r\n    globalThis.LastLapTime = \r\n        minutes.toString().padStart(2, '0') + \":\" +\r\n        seconds.toString().padStart(2, '0') + \".\" +\r\n        milliseconds.toString().padStart(3, '0');\r\n\r\n    globalThis.LapStartTime = RaceTime;  // Store new lap start time\r\n    globalThis.CompletedLapStored = CompletedLaps;\r\n}\r\n\r\n// **Always return the last valid lap time instead of resetting to 00:00.000**\r\nreturn globalThis.LastLapTime;"},"Mode":2},"TextColor":{"Formula":{"JSExt":0,"Interpreter":1,"Expression":"var CompletedLaps = $prop('CompletedLaps');\r\nvar RaceTime = $prop('GameRawData.CurrentRaceTime');\r\nvar BestLapTime = $prop('BestLapTime');\r\n\r\n// Initialize global variables if not set\r\nif (typeof globalThis.LapStartTime === 'undefined') {\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.LastLapTime = 0; // Stored as seconds\r\n    globalThis.CompletedLapStored = 0;\r\n    globalThis.LastLapColor = \"#ffffff\"; // Default color (white)\r\n    globalThis.ColorEndTime = 0; // Timer for color change duration\r\n}\r\n\r\n// **Hard reset when a new session starts**\r\nif (CompletedLaps === 0 || RaceTime < globalThis.LapStartTime) {\r\n    globalThis.LapStartTime = RaceTime;\r\n    globalThis.LastLapTime = 0;\r\n    globalThis.CompletedLapStored = 0;\r\n    globalThis.LastLapColor = \"#ffffff\";\r\n    globalThis.ColorEndTime = 0;\r\n    return globalThis.LastLapColor;\r\n}\r\n\r\n// **Capture lap times based on CompletedLaps update**\r\nif (CompletedLaps > globalThis.CompletedLapStored) {\r\n    var lapTime = RaceTime - globalThis.LapStartTime; // Time difference in seconds\r\n    globalThis.LapStartTime = RaceTime; // Update start time for next lap\r\n    globalThis.LastLapTime = lapTime; // Store lap time\r\n    globalThis.CompletedLapStored = CompletedLaps;\r\n\r\n    // **Check if BestLap is valid**\r\n    var bestLapSeconds = BestLapTime ? timespantoseconds(BestLapTime) : null;\r\n    if (bestLapSeconds && bestLapSeconds > 0) {\r\n        var lapDiffPercentage = (lapTime / bestLapSeconds) * 100;\r\n\r\n        if (lapDiffPercentage <= 100.125) {\r\n            globalThis.LastLapColor = \"#00ff7f\"; // Green for good lap\r\n        } else {\r\n            globalThis.LastLapColor = \"#ff0033\"; // Red for slow lap\r\n        }\r\n\r\n        globalThis.ColorEndTime = RaceTime + 1.2; // Set 1.2s duration\r\n    }\r\n}\r\n\r\n// **Handle color reset after 1.2s**\r\nif (RaceTime >= globalThis.ColorEndTime) {\r\n    globalThis.LastLapColor = \"#ffffff\"; // Reset to white\r\n}\r\n\r\n// **Return the current color**\r\nreturn globalThis.LastLapColor;"},"Mode":2},"BlinkEnabled":{"Formula":{"Expression":"changed(1199, [CompletedLaps])"},"Mode":2},"Left":{"Formula":{"Expression":"if([CurrentLap] > 2 && changed(3000, [CurrentLap]) && !changed(3000, [BestLapTime]), 114, 314)"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":38.0,"Text":"44:44.444","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":114.0,"Top":245.8,"Visible":true,"BlinkDelay":200.0,"BlinkEnabled":true,"Width":137.2,"Name":"LAST-if-PB","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Text":{"FormatString":"mm\\:ss\\.fff","Formula":{"Expression":"[BestLapTime]"},"Mode":2},"TextColor":{"Formula":{"Expression":"if(changed(1200, [CurrentLap]) && changed(1200, [BestLapTime]), '#9500ff', '#ffffff')"},"Mode":2},"BlinkEnabled":{"Formula":{"Expression":"changed(1199, [CompletedLaps])"},"Mode":2},"Visible":{"Formula":{"Expression":"changed(3000, [CurrentLap]) && changed(3000, [BestLapTime])"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"LAST","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":17.8,"Top":245.8,"Visible":true,"Width":105.0,"Name":"LAST","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Visible":{"Formula":{"Expression":"changed(3000, [CurrentLap])"},"Mode":2}}}],"Visible":true,"Name":"Last","RenderingSkip":10,"MinimumRefreshIntervalMS":100.0},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":true,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"BEST","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":17.8,"Top":198.8,"Visible":true,"Width":105.0,"Name":"BEST","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":38.0,"Text":"44:44.444","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":114.0,"Top":198.8,"Visible":true,"Width":136.2,"Name":"BEST-Time","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Text":{"FormatString":"mm\\:ss\\.fff","Formula":{"Expression":"if(\r\n  [CurrentLap] = 1,\r\n  if(\r\n    timespantoseconds([AllTimeBest]) = 1,\r\n    '--:---.---',\r\n    [AllTimeBest]\r\n  ),\r\n  if(\r\n    timespantoseconds([BestLapTime]) = 0,\r\n    '--:---.---',\r\n    [BestLapTime]\r\n  )\r\n)"},"Mode":2}}}],"Visible":true,"Name":"Best","RenderingSkip":10,"MinimumRefreshIntervalMS":100.0,"Bindings":{"Visible":{"Formula":{"Expression":"[CurrentLap] > 1"},"Mode":2}}},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.Layer, SimHub.Plugins","Group":false,"Repetitions":0,"IsFreezed":true,"Childrens":[{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"CURRENT LAP","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":40.6,"Left":17.8,"Top":84.9,"Visible":true,"Width":169.2,"Name":"C-LAP","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont BigNum","FontSize":66.0,"Text":"44:44.444","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"CharWidth":29.6,"SpecialCharsWidth":12.5,"BackgroundColor":"#00FFFFFF","Height":82.9,"Left":16.8,"Top":122.8,"Visible":true,"Width":236.2,"Name":"CURRENT-Lap","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Text":{"FormatString":"mm\\:ss\\.fff","Formula":{"JSExt":0,"Interpreter":1,"Expression":"var CompletedLaps = $prop('CompletedLaps');\r\nvar RaceTime = $prop('GameRawData.CurrentRaceTime');\r\nvar BestLapTime = $prop('BestLapTime');\r\n\r\n// Initialize global variables if not set\r\nif (typeof globalThis.BestLapStored === 'undefined') {\r\n    globalThis.BestLapStored = 0;\r\n    globalThis.LapStart = 0;\r\n    globalThis.CompletedLapStored = 0;\r\n}\r\n\r\n// Hard reset conditions\r\nif (BestLapTime === 0 || CompletedLaps === 0 || \r\n    CompletedLaps !== globalThis.CompletedLapStored) {\r\n    globalThis.BestLapStored = BestLapTime;\r\n    globalThis.LapStart = RaceTime;\r\n    globalThis.CompletedLapStored = CompletedLaps;\r\n    return \"00:00.000\";\r\n}\r\n\r\n// Calculate elapsed time\r\nvar elapsed = RaceTime - globalThis.LapStart;\r\n\r\n// Prevent negative times\r\nif (elapsed < 0) {\r\n    globalThis.LapStart = RaceTime;\r\n    elapsed = 0;\r\n}\r\n\r\nvar minutes = Math.floor(elapsed / 60);\r\nvar seconds = Math.floor(elapsed % 60);\r\nvar milliseconds = Math.floor((elapsed - Math.floor(elapsed)) * 1000);\r\n\r\n// Format output as mm:ss.fff\r\nvar formattedTime = minutes.toString().padStart(2, '0') + \":\" +\r\n                    seconds.toString().padStart(2, '0') + \".\" +\r\n                    milliseconds.toString().padStart(3, '0');\r\n\r\nreturn formattedTime;"},"Mode":2},"TextColor":{"Formula":{"Expression":"if([PersistantTrackerPlugin.LapInvalidated] = 'true', '#ff0000', '#ffffff')"},"Mode":2},"Visible":{"Formula":{"Expression":"if([CurrentLap] > 1 && timespantoseconds([LastLapTime]) = 0, 1, 0)"},"Mode":2}}}],"Visible":true,"Name":"Current lap","RenderingSkip":0,"MinimumRefreshIntervalMS":1.0},{"$type":"SimHub.Plugins.OutputPlugins.GraphicalDash.Models.TextItem, SimHub.Plugins","IsTextItem":true,"ShadowDepth":3,"ShadowColor":"#A1000000","Font":"ForzaFont Text","FontSize":38.0,"Text":"PEN","TextColor":"#FFFFFFFF","HorizontalAlignment":0,"VerticalAlignment":1,"BackgroundColor":"#00FFFFFF","Height":42.0,"Left":17.8,"Top":37.2,"Visible":false,"Width":105.0,"IsFreezed":true,"Name":"PEN","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0}],"Visible":false,"Name":"Timed Race","RenderingSkip":0,"MinimumRefreshIntervalMS":0.0,"Bindings":{"Visible":{"Formula":{"Expression":"if([CurrentLap] > 1 && timespantoseconds([LastLapTime]) = 0, 1, 0)"},"Mode":2}}}],"MinimumRefreshIntervalMS":0.0}],"SnapToGrid":false,"HideLabels":true,"ShowForeground":false,"ForegroundOpacity":100.0,"ShowBackground":true,"BackgroundOpacity":100.0,"ShowBoundingRectangles":false,"GridSize":10,"Images":[],"Metadata":{"ScreenCount":1.0,"InGameScreensIndexs":[0],"IdleScreensIndexs":[0],"MainPreviewIndex":0,"IsOverlay":true,"OverlaySizeWarning":false,"MetadataVersion":2.0,"EnableOnDashboardMessaging":true,"PitScreensIndexs":[],"SimHubVersion":"9.7.2","Title":"Art-Timing-Sheet","Author":"Artiick","Width":264.0,"Height":315.0,"DashboardVersion":""},"ShowOnScreenControls":true,"IsOverlay":true,"EnableClickThroughOverlay":true,"EnableOnDashboardMessaging":true}